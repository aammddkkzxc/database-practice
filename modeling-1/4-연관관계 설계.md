### 관계형 데이터베이스의 관계
- 무 방향성 : 관계형 DB의 관계는 방향이 없으며, 외래 키(FK)와 JOIN으로 양방향 조회
- 핵심 속성 : 관계는 카디널리티(연결되는 행의 수)와 참여도(관계 참여의 필수/선택 여부)로 정의됨

#### 참여도 (Optionality)
- 구현 : 외래 키 컬럼의 NULL 허용 여부
  - 선택 참여 : 외래 키 NULL 허용
  - 필수 참여 : 외래 키 NOT NULL 설정, 데이터 무결성 강제
- 한계
  - 외래 키가 없는 쪽 (부모)에서 필수 참여 규칙을(예: 팀은 최소 1명의 회원 보유)은 DB 기본 제약으로 강제할 수 없음
  - 보통 **애플리케이션 계층**에서 로직으로 처리
  - DB에서 강제할 수 없더라도, ERD에는 원래의 비즈니스 규칙을 명확하게 표현해야 한다

### 일대다(1:N)
- 외래 키 위치 : 외래 키는 반드시 '다(N)' 쪽에 위치
- 일(1) 쪽에 FK를 두면 안 되는 이유
  - 제1정규형 위반 : 한 컬럼에 여러 값을 저장하게 되어 컬럼의 원자성 원칙을 위배함
  - 무결성 훼손 : 참조 무결성 제약이 불가능해짐
  - 확장성 부재 : 데이터 변경 시 테이블 구조를 계속 바꿔야 함
- 부모/자식 테이블
  - 부모 테이 블: '일(1)' 쪽, 참조되는 테이블
  - 자식 테이블 : '다(N)' 쪽, 외래 키를 가지고 참조하는 테이블

### 일대일(1:1) 관계
대부분의 경우 하나의 테이블로 합치는 것이 효율적이지만, 다음과 같은 전략적인 이유로 사용

- 사용 이유
  - 성능 최적화 : 자주 쓰이는 핵심 데이터와 가끔 쓰이는 부가 데이터를 분리하여 조회 성능을 높인다
  - 보안 강화 : 민감한 정보를 별도 테이블로 분리하고 접근 권한을 엄격하게 제어
  - 선택적 정보 표현 : 일부 레코드에만 해당하는 정보를 별도 테이블로 관리하여 불필요한 NULL 값을 줄인다
    - 모든 회원이 판매자는 아니다
    - 판매자 정보(상호명, 사업자 등록번호, 정산 계좌 등)를 모든 member 테이블에 컬럼으로 추가하는 것은 비효율적
    - 테이블 분리
  - 비지니스 모델 분리, 생명주기 : '주문'과 '배송'처럼 관리 주체가 다른 데이터를 분리, 따로 관리할 수 있도록 하고, 독립적인 확장성 보장(추후 합배송,해외배송 등등)
- 관계 설정
  - 데이터베이스 수준에서 1:1 관계를 강제하려면, 외래 키(FK)가 있는 컬럼에 **UNIQUE 제약조건**을 추가
  - 중복된 값이 들어가지 않도록 해야 한다
- 외래 키(FK) 위치
  - 1:1 관계에서는 FK를 어느 테이블에 두어도 이론적으로는 성립하지만, 실무에서는 보조 테이블에 FK를 두는 것이 표준으로 권장 
  - 보조 테이블에 FK (권장) 
    - 이 방식은 주 테이블의 구조 변경 없이 새로운 1:1 관계를 계속 추가할 수 있어 **확장성**이 매우 뛰어나다
    - 또한, 필요시 UNIQUE 제약조건만 제거하여 **1:N 관계로 쉽게 전환**할 수 있는 유연성
    - 이는 소프트웨어 설계의 개방-폐쇄 원칙(OCP)을 만족하는 좋은 설계
  - 주 테이블에 FK (예외적)
    - 주 테이블만 보고도 보조 정보의 존재 여부를 바로 확인할 수 있긴 하다
    - 확장 힘듦, 관계 변경 사실상 불가
    - 조회 빈도가 매우 높고, JOIN 비용을 최소화해야 하는 경우 사용 가능성이 조금이나마 있긴 하다

### 다대다(M:N) 관계
- 다대다 관계는 '하나의 주문에 여러 상품이 포함되고, 하나의 상품이 여러 주문에 속할 수 있는' 경우처럼 비즈니스 로직에서 매우 흔하게 나타난다
- 관계형 데이터베이스의 한계
  - 관계형 데이터베이스는 PK의 유일성, FK의 단일 행 참조, 컬럼의 원자성 이라는 구조적 제약 때문에 두 개의 테이블만으로는 M:N 관계를 직접 표현할 수 없다
  - 어느 한쪽에 FK를 두려고 시도하면 필연적으로 이러한 기본 제약을 위반하게 된다
- M:N 관계의 표준 해법은 중간에 연결 테이블을 새로 만들어, 기존의 M:N 관계를 두 개의 일대다(1:N) 관계로 풀어내는 것
- 연결 테이블은 단순히 관계를 이어주는 기술적 역할을 넘어, 관계 자체에서 발생하는 추가적인 속성(예: 주문 수량, 주문 당시 가격)을 저장
  - 비즈니스 의미를 갖고 설계되는 경우가 많다
- 모델링 관점
- 속성이 없는 M:N 관계 (이론적)
  - 개념적 모델링에서는 M:N 관계로 표현되지만, 관계형 데이터베이스를 위한 논리적 모델링에서는 1:N 관계로 풀어냄
- 속성이 있는 M:N 관계 (실무적)
  - 개념적 모델링 단계에서부터 관계 속성으로 인해 '연관 엔티티'가 등장하여 1:N 관계로 표현
  - 논리적 모델링에서는 이 구조를 그대로 테이블로 구현합니다
  - 실무에서는 대부분 숨겨진 속성이 발견되므로, M:N 관계를 발견하면 그 관계 자체의 속성을 고민하는 것이 중요

