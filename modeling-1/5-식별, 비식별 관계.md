### 식별 관계 vs. 비식별 관계 : 핵심 개념
- 부모 테이블의 기본 키를 물려받아 자식 테이블의 '기본 키(PK)의 일부'로 사용하는가
- 아니면 부모 테이블 의 기본 키를 단순히 '일반 컬럼'으로만 사용하느냐

#### 식별 관계
- 부모 테이블의 기본 키를 자식 테이블의 **기본 키(PK)의 일부**이자 외래 키(FK)로 사용
- 자식의 존재나 식별이 부모에게 강력하게 의존하는 관계입
  - '아파트 101동' 없이는 '502호'가 온전히 식별될 수 없는 것처럼, 부모 정보가 자식 식별의 필수 요소가 된다
- 자식 엔티티 -> 부모 없이는 존재 의미가 없는 '약한 엔티티(Weak Entity)'

#### 비식별 관계 (Non-identifying Relationship)
- 부모 테이블의 기본 키를 자식 테이블의 **일반 컬럼**이자 외래 키(FK)로만 사용
- 자식 테이블은 자신만의 고유한 기본 키를 별도로 가진다
- 부모와의 연결이 자식의 식별에 필수적이지 않은 관계
  - 'A회사'의 '사원번호 777번'처럼, 사원은 사원번호만으로 독립적인 식별이 가능
- 자식 엔티티 -> 독립적으로 존재할 수 있는 '강한 엔티티(Strong Entity)'

### 관계 유형별 비교 (1:N, 1:1, M:N)

#### 일대다(1:N) 관계
- 비식별 관계 : 자식 테이블(댓글)이 독립적인 PK(comment_id)를 가져 구조가 단순하고, 관계 변경(댓글 이동)에 유연
- 식별 관계 : 자식 테이블이 부모 PK를 포함한 복합키(board_id, comment_no)를 사용

#### 일대일(1:1) 관계
- 비식별 관계
  - 자식 테이블이 독립 PK를 가지며, 1:1 관계 보장을 위해 FK에 **UNIQUE 제약조건**을 추가
  - 향후 관계가 1:N으로 변경될 때, 이 제약조건만 제거하면 되므로 매우 유연
- 식별 관계
  - 자식 테이블이 부모의 PK를 그대로 자신의 PK로 사용

#### 다대다(M:N) 관계
- 비식별 관계
  - 연결 테이블이 독립적인 PK(대리 키)를 사용하고, 비즈니스 규칙(예: 주문 당 동일 상품 중복 방지)은 두 부모의 FK 조합에 **UNIQUE 제약조건**을 걸어 보장
  - 규칙이 변경되어도 PK는 그대로 두고 UNIQUE 제약조건만 수정
- 식별 관계
  - 양쪽 부모의 PK를 조합한 복합키를 사용
  - PK 자체가 비즈니스 규칙을 강제

#### 식별 관계의 핵심 문제점
현대 데이터베이스 설계에서 식별 관계를 기피하는 이유는 다음과 같은 심각한 문제점 때문

- 유연성 부족
  - 부모와 자식이 PK로 강하게 묶여(Tight Coupling) 있어, 한 번 맺어진 관계를 변경하기 매우 어렵다
  - 특정 댓글을 다른 게시글로 옮기려면 댓글의 PK 자체를 수정해야 하는데, 이는 데이터베이스 설계 원칙에 위배되며 데이터 무결성을 깰 수 있는 위험한 작업
- PK 컬럼의 전파
  - 부모-자식-손자로 이어지는 계층 구조에서, 상위 부모들의 PK가 계속해서 하위 테이블로 전파되고 누적 
  - 이로 인해 손자 테이블의 PK는 여러 컬럼으로 구성된 복합키가 되어 비대해지고, 이는 SQL 쿼리, JOIN, ORM 매핑을 매우 복잡하게 만든다


### 현대적인 설계 트렌드 : 비식별 관계가 표준인 이유
과거에는 논리적 명확성이나 저장 공간 절약 등의 이유로 식별 관계가 선호되기도 했지만, 소프트웨어의 복잡성이 증가하고 비즈니스 요구사항이 끊임없이 변하는 현대에는 그 단점이 훨씬 크다

- 압도적인 유연성과 민첩성 : 요구사항 변경 시 PK를 건드리지 않고 관계나 규칙을 수정할 수 있어 변화에 민첩하게 대응할 수 있다
- 단순성과 일관성 : 모든 테이블이 단일 대리 키를 PK로 갖는 구조는 이해하고 예측하기 쉬워 개발 생산성을 높인다
- ORM 친화성 : JPA/Hibernate 같은 현대 ORM 기술은 독립적인 단일 식별자를 갖는 비식별 관계 모델에 최적화되어 있다
- 비즈니스 로직과의 분리 : 테이블의 신원(PK)을 '주민등록번호'와 같은 비즈니스 값과 분리함으로써, 외부 정책이나 규칙 변경으로부터 데이터 구조를 안전하게 보호

### 거의 대부분의 경우 설계 원칙
- 실무에서 따라야 할 현대적 데이터베이스 설계의 원칙
- 기본 키 : 대리 키 사용 (BIGINT AUTO_INCREMENT)
- 관계 : 모든 관계는 비식별 관계로 설계
- 규칙 : 비즈니스적 데이터 중복 방지 등은 **UNIQUE 제약조건**을 활용하여 해결