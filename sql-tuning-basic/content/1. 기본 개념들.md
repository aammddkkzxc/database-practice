# sql 튜닝 공부 전 기본 개념들

### DB 성능 개선할 때 ‘SQL 튜닝’을 가장 먼저 해야 하는 이유

-  DB 성능을 개선하는 방법
  - DB에 부하가 걸렸을 때 성능을 개선하는 방법은 다양하다.
    - SQL 튜닝
    - 캐싱 서버 활용 (Redis 등)
    - 레플리케이션 (Master/Slave 구조)
    - 샤딩
    - 스케일업 (CPU, Memory, SSD 등 하드웨어 업그레이드)
- sql 튜닝을 가장 먼저 고려해야 하는 이유
  - 나머지 방법들은 추가적인 시스템을 구축해야함 -> 금전적 비용이 추가적으로 들어간다는 의미
  - sql튜닝은 기존의 시스템 변경 없이 성능 개선
  - 근본적인 문제를 해결하는 방법이 SQL 튜닝일 가능성이 높다.
  - SQL 자체가 비효율적으로 작성됐다면 아무리 시스템적으로 성능을 개선한다고 하더라도 한계가 있다
 
### mysql 아키텍처

![image](https://github.com/user-attachments/assets/77c659fd-6627-4bbd-be12-da21980c1c25)

1. 클라이언트가 DB에 SQL 요청을 보낸다.
2. MySQL 엔진에서 **옵티마이저**가 주어진 SQL문을 바탕으로 빠르고 효율적으로 데이터를 가져올 수 있는 계획을 세운다. 어떤 순서로 테이블에 접근할 지, 인덱스를 사용할 지, 어떤 인덱스를 사용할 지 등을 결정.
3. 옵티마이저가 세운 계획을 바탕으로 스토리지 엔진에서 데이터를 가져온다.
  - DB 성능에 문제가 생기는 대부분의 원인은 스토리지 엔진으로부터 데이터를 가져올 때 발생한다.
  - 데이터를 찾기가 어려워서 오래 걸리거나, 가져올 데이터가 너무 많아서 오래 걸린다.
  - SQL 튜닝의 핵심은 스토리지 엔진으로부터 되도록이면 데이터를 찾기 쉽게 바꾸고, 적은 데이터를 가져오도록 바꾸는 것
4. MySQL 엔진에서 정렬, 필터링 등의 마지막 처리를 한 뒤에 클라이언트에게 SQL 결과를 응답

</br>

- sql튜닝 핵심은 두가지이다
  - 스토리지 엔진에서 데이터를 찾기 쉽도록
  - 스토리지 엔진에서 가져오는 데이터의 양을 줄인다
- 인덱스를 적절하게 활용한다면 효과적으로 성능 개선을 할 수 있다.
